---
difficulty: Easy
---

import EntrySearch from "@site/src/components/EntrySearch";
import Image from "@site/src/components/Image";
import Player from "@site/src/components/Player";
import StateFlow from '@site/src/components/StateFlow';
import { SplitLayout, Section } from '@site/src/components/SplitLayout';
import EntryDisplay from "@site/src/components/EntryDisplay";

# Задание: убить зомби
:::info[Before starting]
Перед началом рекомендуем прочитать раздел [Квесты](./index.mdx).
:::
:::warning[NPC]
Этот урок требует, чтобы у вас уже был NPC, созданный по руководству [Entity Extension](../04-entity-extension/index.mdx).
:::

In this tutorial, you will learn how to create a quest where:
- игрок взаимодействует с NPC
- NPC выдаёт квест с целью убить 2 зомби
- игрок выполняет цель, убивая 2 зомби
- затем возвращается к NPC для завершения квеста

<SplitLayout>
<Section divider='left'>
## Quest Flow
<StateFlow
  nodes={[
    {
      id: 'not-started',
      title: 'Not Started',
      facts: ['Zombie Quest Fact = 0'],
      className: 'bg-gray-100 dark:bg-zinc-600 ring-1 ring-[#1f2937] dark:ring-white',
      description: 'Player hasn\'t started the quest yet',
      icon: 'tabler:circle-dot',
      transitions: [
        { 
          targetId: 'quest-received', 
          label: 'Talk to NPC', 
          icon: 'tabler:message-circle' 
        }
      ]
    },
    {
      id: 'quest-received',
      title: 'Quest Received',
      facts: ['Zombie Quest Fact = 1', 'Kill Zombie Fact = 0'],
      className: 'bg-[#eef9fd] dark:bg-[#193c47] ring-cyan-500 border-cyan-100 dark:border-cyan-800',
      description: 'Player has received the quest from the NPC',
      icon: 'tabler:message-circle',
      transitions: [
        { 
          targetId: 'killing', 
          label: 'Kill Zombies', 
          icon: 'tabler:sword' 
        }
      ]
    },
    {
      id: 'killing',
      title: 'Killing Zombies',
      facts: ['Zombie Quest Fact = 1', 'Kill Zombie Fact >= 2'],
      className: 'bg-[#eef9fd] dark:bg-[#193c47] ring-[#4cb3d4] border-cyan-100 dark:border-cyan-800',
      description: 'Player is killing zombies',
      icon: 'tabler:sword',
      transitions: [
        { 
          targetId: 'completed', 
          label: 'Return to NPC', 
          icon: 'tabler:arrow-back-up' 
        }
      ]
    },
    {
      id: 'completed',
      title: 'Completed',
      facts: ['Zombie Quest Fact = 2'],
      className: 'bg-[#e6f6e6] dark:bg-[#003100] ring-[#009400] border-green-100 dark:border-green-800',
      description: 'Player has completed the quest by killing 2 zombies',
      icon: 'tabler:check-circle',
      transitions: [
        { 
          targetId: 'not-started', 
          label: 'Reset Quest', 
          icon: 'tabler:arrow-back-up' 
        }
      ]
    }
  ]}
/>
</Section>
<Section divider='right'>
## Quest Setup
This guide is split up into 2 sections. 
- [**Manifest Section**](#manifest-section): Covers how to set the quest up and add the objective.
- [**Sequence Section**](#sequence-section): Explains how to make the npc give the quest and how to make the objective completable.

</Section>
</SplitLayout>

## Manifest Section
:::warning[Before Starting]
Перед началом убедитесь, что прошли руководство [Entity Extension](../04-entity-extension/index.mdx).
> В этом примере квест выдаёт NPC по имени Oliver.

Также убедитесь, что у вас есть страница manifest.
:::
> В этом разделе мы настроим квест и добавим цель в manifest.
### Creating the Quest
На странице manifest нажмите **+** и добавьте `Quest`.

<EntrySearch entryName="quest" />

#### Configuring the Quest Entry
Теперь в записи квеста установите следующие параметры:
* **Display Name**: `ZombieQuest`
* **Active Criteria**: `Zombie Quest Fact >= 1`
* **Completed Criteria**: `Zombie Quest Fact = 2`\
*For this guide I used a permanent fact*

### Adding the Objective
Теперь в квесте нажмите **+** и выберите `Completable Objective`.

<EntrySearch entryName="completable_objective" />

### Configuring the Objective Entry
Now inside the objective entry set the following fields:
* **Quest**: `ZombieQuest`
* **Show Criteria**: `Zombie Quest Fact = 1`
* **Completed Criteria**: `Zombie Quest Fact = 1` + `Killed Zombies Fact >= 2`
* **Display**: `Kill 2 Zombies`
:::tip[Optional]
Inside the display you can also choose the display the progress using [PlaceHolderAPI](../../05-helpful-features/03-placeholderapi.mdx)

*Example:* `Kill 2 zombies (%typewriter_nOfQzADcAmcR6ao%/2)`

> We will be using this in the final result!
:::
:::tip[Optional #2]
You can also add a second objective that requires the player to return to the NPC.

* **Show Criteria**: `Zombie Quest Fact = 1` + `Kill Zombie Fact >= 2`
* **Completed Criteria**: `Zombie Quest Fact = 2`
* **Display**: `Return to Oliver`

See [talk objective](./01-talk-objective.mdx) for more information on how to do this.
:::

### Manifest Result
<EntryDisplay pages={[
    require("../../assets/questing/kill-zombie-objective/manifest.json"),
    require("../../assets/questing/kill-zombie-objective/static.json")
]} />

## Sequence Section
:::info[Before Starting]
It is recommended to have a good understanding of [Interactions](../01-interactions/index.mdx) and [Facts](../03-facts/index.mdx) before starting this section.
:::
> В этой части создадим последовательность, выдающую квест и позволяющую выполнить цель.

### Взаимодействие с Оливером
Создадим взаимодействие с Оливером — здесь игрок получит квест.
Нажмите **+** и выберите `Add Entity Interact Event`.

<EntrySearch entryName="entity_interact_event" />

Внутри укажите Definition `Oliver` (или своё имя NPC).

### Диалог с Оливером
При нажатии на Оливера ничего не происходит. Добавим ему реплики.
> Шаги ниже необязательны, но делают задание интереснее.
1. Add a `New Option` to your sequence and set the following fields:
   * **Text**: `Could you help me with something?`
   * **Option 1**: `Yeah sure, whats up?`
   * **Option 2**: `No sorry.`
2. Now in the option 1 add a trigger for a spoken with fields:
   * **Text**: `Go kill 2 zombies.`
   * **Duration**: `1s`
3. Inside that spoken add a modifier: `Zombie Quest Fact = 1`

### Увеличение счётчика при убийстве
Чтобы увеличить факт при убийстве зомби, добавьте событие `On Player Kill Entity`.

<EntrySearch entryName="on_player_kill_entity" />

Inside the entry enable the Enity Type and set the Entity Type to `Zombie`.

В событии включите Entity Type и выберите `Zombie`.
Now we need to increase the fact when the player kills a zombie. To do this right click on the `On Player Kill Entity` and select `Link with ...` select the `Triggers | 1` and search for `Add Simple Action`.

Правой кнопкой по `On Player Kill Entity` выберите `Link with ...`, затем `Triggers | 1` и найдите `Add Simple Action`.

Inside the entry set the following fields:
* **Criteria**: `Zombie Quest Fact = 1`
* **modifier**: `Zombies Killed Fact + 1`  

Это увеличит факт на 1 при каждом убийстве зомби, если квест активен.

### Sequence Result
<EntryDisplay pages={[
    require("../../assets/questing/kill-zombie-objective/sequence.json"),
    require("../../assets/questing/kill-zombie-objective/manifest.json"),
    require("../../assets/questing/kill-zombie-objective/static.json")
]} />

## Final Result
Теперь при нажатии на Оливера появится диалог и после выбора первого варианта начнётся квест. Убив 2 зомби, вы выполните цель.

<Player url={require("../../assets/questing/kill-zombie-objective/kill-zombie-objective-result.webm").default} />
