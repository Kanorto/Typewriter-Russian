---
difficulty: Normal
---

import EntrySearch from '@site/src/components/EntrySearch';
import Player from '@site/src/components/Player';
import Tabs from '@theme/Tabs';
import TabItem from '@theme/TabItem';
import Image from "@site/src/components/Image";
import Admonition from '@theme/Admonition';
import ActionButton from '@site/src/components/ActionButtons'; 

# Дорожная сеть
:::info[Перед началом]
Это руководство предполагает, что расширение Road Network уже установлено.\
Также убедитесь, что вы прочитали документацию по [макету](../../02-getting-started/02-layout.mdx) и создали **статическую** страницу.
:::

Дорожные сети необходимы, если вы хотите, чтобы NPC перемещались по карте или чтобы игрок мог следовать по пути. В этом руководстве мы покажем, как создать дорожную сеть и использовать её в вашей истории.

## Что такое дорожная сеть
Дорожная сеть — это внутренняя графовая структура, которую Typewriter использует для эффективного расчёта маршрутов между двумя удалёнными точками.

## Создание дорожной сети
Для начала нам нужно добавить на страницу запись `Base Road Network`. Чтобы добавить её, нажмите значок «+» в правом верхнем углу панели и введите `base road network`, затем нажмите «+», чтобы добавить запись на страницу.

<EntrySearch entryName='base_road_network' />

### Открытие режима содержимого 
В записи `Base Road Network` в инспекторе нажмите на значок <ActionButton button='capture'/> рядом с полем ArtifactId, чтобы открыть режим содержимого.

### Добавление узла
Теперь, когда мы открыли режим содержимого, нам нужно добавить узел. Узлы — это точки в мире, которые можно соединять друг с другом рёбрами. Чтобы добавить узел, выберите в панели быстрого доступа алмаз и щёлкните им ПКМ. Это откроет редактор узлов. Чтобы выйти из меню узла, нажмите на эндер‑кристалл.

### Создание пути
Чтобы создать путь, вам всегда потребуется 2 узла. Создайте 2 узла, затем выберите красную пыль в панели быстрого доступа и щёлкните ей ПКМ. Теперь это должно выглядеть примерно так:

Теперь у вас есть путь. Вы можете расширять дорожную сеть неограниченным количеством узлов и создавать между ними пути.
:::tip[Размещение узлов]
Рекомендуется создавать узлы в начале и конце дороги или тропинки в вашем мире. Это позволяет экономить ресурсы на загрузке и пересчёте рёбер.
:::

### Редактирование узла
Находясь в редакторе узлов, у вас есть 4 варианта:
<Tabs groupId="node-editor" queryString>
  <TabItem value="change-radius" label="Change Radius" default>
    #### Зачем нужен радиус?
При поиске пути от узла A будут проверяться все узлы в радиусе **30 блоков**, например узлы B, C, D, E, F и G. Если будет обнаружено, что путь к узлу C проходит через радиус узла B, расчёт пути к C прекратится. Это сделано потому, что алгоритм избегает путей, которые должны пропускать такие узлы, как B.
    
    <Image img={require("../../assets/road-network/radius.png")} alt="road-network radius explanation" />
#### Как использовать?
Чтобы изменить радиус узла, выберите сенсор скалка в панели быстрого доступа и щёлкните им ПКМ.
    :::warning[Клик по узлу]
При щелчке ПКМ предметом нельзя наводить курсор на редактируемый узел — это откроет режим содержимого и не вызовет событие.
Затем с помощью колёсика мыши можно изменить радиус узла.
    <Player url={require("../../assets/road-network/radius.webm").default} />
  </TabItem>
  <TabItem value="remove-edge" label="Удалить связь">
    #### Зачем удалять связь?
Удаление связи может быть полезно, когда вам нужно, чтобы путь пропускал узел или был односторонним.

#### Как использовать?
Чтобы удалить связь, выберите красную пыль в панели быстрого доступа и щёлкните ПКМ по узлу, с которого хотите удалить связь.
<Player url={require("../../assets/road-network/remove-edges.webm").default} />
:::warning[Пересчёт]
После добавления или удаления отрицательного узла необходимо пересчитать связи с помощью красной пыли из панели быстрого доступа.
:::

#### Односторонний путь
Чтобы сделать путь односторонним, помимо простого клика ПКМ также удерживайте Shift. Это сделает связь односторонней.
<Player url={require("../../assets/road-network/remove-edge.webm").default} />
  </TabItem>
  <TabItem value="fast-travel" label="Add Fast Travel Connection">
Быстрое перемещение используется, чтобы телепортировать NPC к другому узлу, не заставляя его идти пешком.

Чтобы добавить быстрое перемещение, выберите изумруд в панели быстрого доступа и щёлкните ПКМ по узлу, к которому нужно телепортировать.
    <Player url={require("../../assets/road-network/fast-travel.webm").default} />

Чтобы сделать быстрое перемещение односторонним, помимо простого клика ПКМ также удерживайте Shift.
  </TabItem>
Чтобы удалить узел, выберите красный камень в панели быстрого доступа и щёлкните им ПКМ.
    :::warning[Клик по узлу]
При щелчке ПКМ предметом нельзя наводить курсор на редактируемый узел — это откроет режим содержимого и не вызовет событие.
    :::
  </TabItem>
</Tabs>

### Отрицательные узлы
Иногда нужно, чтобы поиск пути не шёл через определённый участок. Например, когда есть место, где алгоритм думает, что можно спрыгнуть или подняться на блок, но этого делать не нужно, можно добавить отрицательный узел, чтобы предотвратить это.
Ниже приведён пример:
<Tabs groupId="negative-nodes" queryString>
  <TabItem value="with" label="С отрицательным узлом" default>
    <Player url={require("../../assets/road-network/negative-nodes-preview.webm").default} />
  </TabItem>
  <TabItem value="without" label="Без отрицательного узла">
     <Player url={require("../../assets/road-network/non-negative-nodes-example.webm").default} />
  </TabItem>
</Tabs>

#### Как добавить отрицательный узел?
Вы можете добавить отрицательный узел, выбрав в режиме содержимого незеритовый слиток в панели быстрого доступа и щёлкнув им ПКМ.
:::warning[Пересчёт]
После добавления или удаления отрицательного узла необходимо пересчитать связи с помощью красной пыли из панели быстрого доступа.
:::

### Подсветка узлов
Когда узлов много, бывает сложно увидеть, какие из них соединены между собой. Чтобы облегчить это, можно подсветить связанные узлы. Для этого выберите светокамень в панели быстрого доступа и щёлкните им ПКМ.

## Завершение
Теперь вы научились успешно настроить дорожную сеть.
