---
difficulty: Normal
---

import EntrySearch from '@site/src/components/EntrySearch';
import Player from '@site/src/components/Player';
import Tabs from '@theme/Tabs';
import TabItem from '@theme/TabItem';
import Image from "@site/src/components/Image";
import Admonition from '@theme/Admonition';
import ActionButton from '@site/src/components/ActionButtons'; 


# Сетевой маршрут
:::info[Прежде чем начать]
Это руководство предполагает, что у вас уже установлен модуль Road Network.\
Также убедитесь, что вы прочитали страницу
[разметка](../../02-getting-started/02-layout.mdx)
и создали **статическую** страницу.
:::

Сетевые маршруты необходимы, если вы хотите перемещать NPC по карте или позволить
игроку следовать пути. В этом руководстве мы покажем, как создать дорожную сеть и
использовать её в своей истории.

## Что такое дорожная сеть
Дорожная сеть — это внутренняя графовая структура, которую Typewriter использует
для эффективного расчёта путей между удалёнными точками.

## Создание дорожной сети
Сначала нам нужно добавить запись `Base Road Network` на страницу. Нажмите значок
«+» в правом верхнем углу панели, найдите `base road network` и добавьте её,
снова нажав на «+».

<EntrySearch entryName='base_road_network' />

### Открываем режим редактирования
В записи `Base Road Network` в инспекторе нажмите на иконку <ActionButton button='capture'/> рядом
с полем ArtifactId, чтобы открыть режим редактирования.

### Добавление узла
После открытия режима нам нужно добавить узел. Узлы — это точки в мире, которые
можно соединять рёбрами. Чтобы добавить узел, выберите в панели быстрых предметов
алмаз и щёлкните ПКМ. Появится редактор узла. Чтобы выйти из меню узла, нажмите на
кристалл края.
<Player url={require("../../assets/road-network/add-node.webm").default} />

### Создание пути
Чтобы создать путь, всегда нужны две точки. Создайте два узла, затем возьмите
красную пыль и щёлкните ПКМ. Должно получиться примерно так:
<Player url={require("../../assets/road-network/path.webm").default} />

Теперь у вас есть путь. Вы можете расширять сеть неограниченным количеством узлов и создавать между ними связи.
:::tip[Расположение узлов]
Рекомендуется ставить узлы в начале и в конце дороги или тропы в вашем мире.
Это экономит ресурсы на загрузку и перерасчёт рёбер.
:::

### Editing a node
When in the node editor, you have 4 options:
<Tabs groupId="node-editor" queryString>
  <TabItem value="change-radius" label="Change Radius" default>
    #### Зачем нужен радиус?
    При поиске пути из узла A проверяются все узлы в радиусе **30 блоков** — например, B, C, D, E, F и G.
    Если путь к узлу C проходит через радиус узла B, поиск прекращается, так как алгоритм избегает маршрутов,
    пропускающих такие узлы.
    
    <Image img={require("../../assets/road-network/radius.png")} alt="road-network radius explanation" />

    #### Как использовать?
    Чтобы изменить радиус узла, возьмите скалковый сенсор и нажмите ПКМ.
    :::warning[Клик по узлу]
    При нажатии ПКМ нельзя наводить курсор на редактируемый узел — иначе откроется режим редактирования,
    и событие не сработает.
    :::

    Затем, прокручивая колёсико мыши, вы можете изменять радиус узла.

    <Player url={require("../../assets/road-network/radius.webm").default} />
  </TabItem>
  <TabItem value="remove-edge" label="Remove Edge">
    #### Зачем удалять ребро?
    Удаление ребра бывает полезно, если нужно, чтобы путь миновал узел или был односторонним.

    #### Как использовать?
    Чтобы удалить ребро, выберите красную пыль и щёлкните ПКМ по узлу, от которого хотите его убрать.
    <Player url={require("../../assets/road-network/remove-edges.webm").default} />

    :::warning[Пересчёт]
    После добавления или удаления отрицательных узлов обязательно пересчитайте рёбра красной пылью.
    :::


    #### Односторонний путь
    Чтобы сделать его односторонним, удерживайте Shift при нажатии ПКМ.

    <Player url={require("../../assets/road-network/remove-edge.webm").default} />
  </TabItem>
  <TabItem value="fast-travel" label="Add Fast Travel Connection">
    #### Зачем добавлять быстрый переход?
    Быстрый переход позволяет телепортировать NPC к другому узлу вместо обычного перемещения.

    #### Как использовать?
    Чтобы добавить быстрый переход, возьмите изумруд и щёлкните ПКМ по узлу, куда нужно телепортировать.

    <Player url={require("../../assets/road-network/fast-travel.webm").default} />

    #### Односторонний переход
    Чтобы сделать его односторонним, удерживайте Shift при нажатии ПКМ.
  </TabItem>
  <TabItem value="remove-node" label="Remove Node">
    Чтобы удалить узел, возьмите блок красного камня и нажмите ПКМ.
    :::warning[Клик по узлу]
    При нажатии ПКМ нельзя наводить курсор на редактируемый узел,
    иначе откроется режим редактирования и событие не сработает.
    :::
  </TabItem>
</Tabs>

### Отрицательные узлы
Иногда необходимо запретить алгоритму прокладывать путь через определённое место.
Например, когда он считает возможным прыжок на один блок выше или ниже, но этого делать не нужно.
В таком случае можно добавить отрицательный узел.\
Пример:
<Tabs groupId="negative-nodes" queryString>
  <TabItem value="with" label="With Negative Node" default>
    <Player url={require("../../assets/road-network/negative-nodes-preview.webm").default} />
  </TabItem>
  <TabItem value="without" label="Without Negative Node">
     <Player url={require("../../assets/road-network/non-negative-nodes-example.webm").default} />
  </TabItem>
</Tabs>

#### Как добавить отрицательный узел?
Выберите незеритовый слиток в режиме редактирования и нажмите ПКМ, чтобы поставить узел.
:::warning[Пересчёт]
После добавления или удаления отрицательного узла пересчитайте рёбра красной пылью.
:::

### Подсветка узлов
Когда узлов много, трудно понять, какие из них соединены.
Чтобы упростить задачу, можно подсветить связанные узлы.
Для этого возьмите светокамень и нажмите ПКМ.

## Итоги
Теперь вы знаете, как настроить дорожную сеть.
