---
difficulty: Hard
---

import Player from "@site/src/components/Player";
import Image from "@site/src/components/Image";
import ActionButton from "@site/src/components/ActionButtons";
import EntrySearch from "@site/src/components/EntrySearch";

# Контекст взаимодействия
:::info[Прежде чем начать]
Перед прохождением этого урока рекомендуем ознакомиться с руководством [Взаимодействия](./index.mdx), так как мы будем опираться на него.
:::

В этом руководстве мы разберёмся, что такое контекст взаимодействия и как им пользоваться. Мы создадим взаимодействие, в котором игрок должен указать количество передаваемых цветов.

## Что такое контекст взаимодействия?
Контекст взаимодействия — мощный инструмент, позволяющий передавать переменные в следующие записи последовательности. Вы можете получить ввод от игрока, сохранить его и использовать позже для создания динамических взаимодействий\
— будь то использование значения на последующих шагах или вызов действий (например, спавн эффекта при клике по блоку). Такая гибкость делает ваши истории более адаптивными и увлекательными.

:::tip[Несколько типов]
В этом уроке мы воспользуемся `диалогом ввода числа`, хотя существуют и другие варианты, например `диалог ввода строки`.
:::

## Создание диалога ввода
Мы создадим взаимодействие, где игрок должен указать количество цветов. Для этого добавим диалог ввода числа, который сохранит указанное количество.
Чтобы добавить диалог, нажмите значок + в правом верхнем углу панели. Найдите `Add Integer Input Dialogue` и добавьте его в последовательность\
(в этом примере он связан со спокеном из раздела [Взаимодействия](./index.mdx)).
<EntrySearch entryName="integer_input_dialogue" />

## Настройка диалога ввода числа
Внутри диалога задайте нужный текст. В нашем случае это будет: `Сколько цветов вы хотите?`.
:::tip[Диапазон]
При желании можно задать допустимый диапазон вводимого числа
:::

## Добавляем выдачу цветов
Теперь создадим событие, которое сработает после того, как игрок введёт количество. Щёлкните правой кнопкой по записи `Integer Input Dialogue` и выберите `+ link with ...`, затем найдите `Give Item` и добавьте его на страницу.

<EntrySearch entryName="give_item" />
:::warning[Запись Give Item]
Если вы не знакомы с записью Give Item, сначала прочитайте раздел [Выдача предметов](../01-interactions/02-items.mdx)
:::

## Настройка выдачи цветов
Теперь настройте запись выдачи. В примере мы используем `красный тюльпан`.
:::danger[Особый предмет]
Необходимо выбрать пользовательский предмет. Пока что количество предметов в сериализованном виде нельзя задавать переменной.
:::
### Создаём переменную контекста взаимодействия
Внутри записи Give Item в поле предмета добавьте дополнительный компонент и выберите количество. Затем в поле количества нажмите на <ActionButton button='dynamic-variable'/> и найдите `Add Interaction Context Variable`.

<EntrySearch entryName="interaction_context_variable" />

После этого выберите в появившемся поле запись `Integer Input Dialogue`.
#### Видеоурок
<Player url={require("../../assets/interactions/configure-spoken-interaction-context.webm").default}/>

## Результат
Теперь, когда игрок указывает количество цветов, он получает именно столько, сколько ввёл.

<Player url={require("../../assets/interactions/interaction-context-result.webm").default}/>
