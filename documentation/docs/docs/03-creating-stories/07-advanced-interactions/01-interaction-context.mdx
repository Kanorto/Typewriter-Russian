---
difficulty: Hard
---

import Player from "@site/src/components/Player";
import Image from "@site/src/components/Image";
import ActionButton from "@site/src/components/ActionButtons";
import EntrySearch from "@site/src/components/EntrySearch";

# Контекст взаимодействия
:::info[Before starting]
Перед началом рекомендуем ознакомиться с руководством [Взаимодействия](./index.mdx), так как мы будем опираться на него.
:::

В этом уроке вы узнаете о контекстах взаимодействия и их применении. Мы создадим взаимодействие, где игрок должен указать количество даримых цветов.

## Что такое контекст взаимодействия?
Контекст взаимодействия — мощная концепция, позволяющая передавать переменные последующим записям в последовательности. Это означает, что вы можете получать пользовательский ввод, сохранять его и использовать позднее для управления динамическими взаимодействиями\
будь то использование введённых данных на следующих шагах или запуск действий (например, появления эффектов на выбранном блоке). Такая гибкость делает ваши истории более адаптивными и увлекательными.

:::tip[Multiple Types]
В этом уроке мы будем использовать `диалоговое окно целочисленного ввода`, но существуют и другие типы, например `диалог ввода строки`.
:::

## Создание диалогового окна ввода
В этом уроке мы создадим взаимодействие, в котором игроку необходимо указать количество отдаваемых цветов. Для этого мы воспользуемся диалоговым окном целочисленного ввода.
Чтобы добавить такое окно, перейдите в правый верхний угол панели и нажмите на значок +. Найдите `Add Integer Input Dialogue` и добавьте его в последовательность\
(В этом руководстве мы связали его со spoken из раздела [Взаимодействия](./index.mdx)).
<EntrySearch entryName="integer_input_dialogue" />

## Настройка диалогового окна целочисленного ввода
Внутри диалогового окна задайте необходимый текст. В этом руководстве используем: `How many flowers would you like?`.
:::tip[Range]
При желании можно также настроить диапазон допустимых значений
:::

## Добавление выдачи цветов
Теперь нужно создать событие, которое будет срабатывать после того, как игрок укажет количество цветов. Щёлкните правой кнопкой по элементу `Integer Input Dialogue` и выберите `+ link with ...`, чтобы открыть поиск. Найдите `Give Item` и добавьте его на страницу.

<EntrySearch entryName="give_item" />
:::warning[Give Item Entry]
Если вы не знаете, как работает элемент Give Item, сначала ознакомьтесь с руководством [Выдача предметов](../01-interactions/02-items.mdx)
:::

## Настройка выдачи цветов
Теперь можно настроить элемент выдачи. В этом примере мы используем `Red Tulip`.
:::danger[Custom Item]
Для предмета необходимо использовать пользовательский предмет. Сейчас количество сериализованного предмета не может быть переменной.
:::
### Создание переменной контекста взаимодействия
Теперь внутри элемента Give Item в поле предмета создайте дополнительный компонент и выберите `amount`. В поле `amount` нажмите <ActionButton button='dynamic-variable'/> и найдите `Add Interaction Context Variable`.

<EntrySearch entryName="interaction_context_variable" />

После этого в поле `Entry` можно выбрать созданный элемент `Integer Input Dialogue`.
#### Видеоурок
<Player url={require("../../assets/interactions/configure-spoken-interaction-context.webm").default}/>

## Результат
Теперь после указания количества цветов игрок получит именно столько, сколько было выбрано.

<Player url={require("../../assets/interactions/interaction-context-result.webm").default}/>