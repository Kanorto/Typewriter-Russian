---
difficulty: Normal
---

import Player from "@site/src/components/Player";
import Image from "@site/src/components/Image";
import EntrySearch from "@site/src/components/EntrySearch";

# Сущности и NPC
:::danger[Entity Extension]
Перед началом этого урока необходимо установить расширение Entity.
:::

Хорошему повествованию необходимы второстепенные персонажи.
Typewriter содержит собственное расширение сущностей, позволяющее создавать и управлять NPC.

## Что такое Entity Extension?
Это расширение упрощает спавн, управление и контроль сущностей, таких как NPC, на вашем сервере.

Вот лишь некоторые возможности:
- **Определение сущности**: создание новой сущности с пользовательскими данными и её спавн, пригодный для повторного использования на разных серверах.
- **Условное отображение**: появление NPC только на определённых этапах квеста.
- **Активности**: добавление действий, например поход в таверну ночью или патрулирование города.

## Создание NPC
Сущности в Typewriter определяются на странице `Manifest`.
Здесь создаётся новая сущность нужного типа,
которую затем можно многократно спавнить с помощью экземпляров сущности.

**NPC** — особая сущность, представляющая игрока с табличкой имени и индикатором над головой.
Это простой в использовании и наиболее распространённый вид сущностей.

### Создание новой дефиниции NPC
Чтобы создать определение NPC, необходимо сделать страницу манифеста и описать в ней NPC. Вот пример:

Начните с **добавления страницы**.
Выберите тип **Manifest** в выпадающем меню и назовите страницу как угодно.
В примере она называется `Characters`.

Подробнее о создании страниц смотрите в разделе [Layout](../../02-getting-started/02-layout.mdx).

Затем нужно описать NPC. Нажмите `Add Entry` или значок `+` в правом верхнем углу,
найдите пункт `Add NPC Definition` и добавьте его на страницу. На экране появится соответствующая запись.

<EntrySearch entryName='npc_definition'/>

# Настройка сущности
Теперь, когда сущность определена, её можно настроить под себя.

## Задание имени сущности
Переименуем запись в `Oliver Definition`.

Чтобы изменить отображаемое имя над головой, в поле `Display Name` укажем `<red><b>Oliver</b></red>`.

<Image img={require("../../assets/entity-extension/entity_name_change.png")} alt="Rename Entry and Entity" width={400} />

## Настройка скина NPC

Изменить скин можно через поле `Skin`.
Оно принимает текстуру и подпись, которые генерируются Minecraft и плохо поддаются редактированию.
К счастью, Typewriter умеет получать их по uuid игрока или ссылке.

Поменяем скин Оливера на этот, найденный на [NameMC](https://s.namemc.com/i/b2319359e305d7a2.png).
Нажмите значок цепочки справа от поля `Skin`, чтобы `Fetch from url`.

Введите ссылку `https://s.namemc.com/i/b2319359e305d7a2.png` и нажмите `Fetch`.

<Player url={require("../../assets/entity-extension/fetch_skin.webm").default} />

## Создание экземпляра NPC
NPC уже определён, но пока не появился в мире.
Чтобы заспавнить его, добавим запись `Entity Instance`.
У каждого типа сущностей своя дефиниция `Entity Instance`.
Для NPC используем `NPC Instance`.

<EntrySearch entryName='npc_instance'/>

Сначала в выпадающем списке `Definition` выберите нужное определение NPC.
Здесь это `Oliver Definition`, созданное ранее.
Оно будет базой для нашего экземпляра.

<Image img={require("../../assets/entity-extension/definition_select.png")} alt="Definition Select" width={400} />

Наконец, задайте точку спавна NPC — место, где он будет появляться, когда первый игрок увидит его.

Это делается через селектор режима контента, который получает координаты вашего клиента Minecraft.

<Player url={require("../../assets/entity-extension/entity_location.webm").default} />


Готово!
Мы создали определение сущности и заспавнили её экземпляр в мире.
Теперь NPC будет виден в игре с заданным именем, скином и данными.

То же самое относится к другим сущностям, например, **коровам** или **жителям**.
Вы можете определить и заспавнить любую сущность через Entity Extension, главное — чтобы тип определения совпадал с типом создаваемого экземпляра.

:::info
Если нужный тип сущности не имеет готового определения или экземпляра, попросите его в нашем [Discord](https://discord.gg/HtbKyuDDBw).
:::
