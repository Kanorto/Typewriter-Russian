"use strict";(self.webpackChunkdocumentation=self.webpackChunkdocumentation||[]).push([[87276],{94779:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>c,contentTitle:()=>d,default:()=>g,frontMatter:()=>o,metadata:()=>r,toc:()=>u});const r=JSON.parse('{"id":"develop/extensions/api-changes/0.8","title":"0.8.X API Changes","description":"There are quite a few changes to the API.","source":"@site/versioned_docs/version-0.8.0/develop/02-extensions/08-api-changes/0.8.mdx","sourceDirName":"develop/02-extensions/08-api-changes","slug":"/develop/extensions/api-changes/0.8","permalink":"/develop/extensions/api-changes/0.8","draft":false,"unlisted":false,"editUrl":"https://github.com/gabber235/Typewriter/tree/develop/documentation/versioned_docs/version-0.8.0/develop/02-extensions/08-api-changes/0.8.mdx","tags":[],"version":"0.8.0","lastUpdatedBy":"Marten Mrfc","lastUpdatedAt":1746955632000,"frontMatter":{"title":"0.8.X API Changes"},"sidebar":"develop","previous":{"title":"0.7.X API Changes","permalink":"/develop/extensions/api-changes/0.7"}}');var i=t(74848),a=t(28453),s=t(11470),l=t(19365);const o={title:"0.8.X API Changes"},d="All API changes to 0.8.X",c={},u=[{value:"<code>build.gradle.kts</code> Changes",id:"buildgradlekts-changes",level:2},{value:"<code>Initializable</code> Changes",id:"initializable-changes",level:2},{value:"Triggering Entries Changes",id:"triggering-entries-changes",level:2},{value:"ActionEntry Changes",id:"actionentry-changes",level:2},{value:"Removal of <code>CustomTriggeringActionEntry</code>",id:"removal-of-customtriggeringactionentry",level:2},{value:"Dialogue Messenger Changes",id:"dialogue-messenger-changes",level:2},{value:"Suspendable <code>AudienceEntry#display</code>",id:"suspendable-audienceentrydisplay",level:2}];function h(e){const n={a:"a",code:"code",h1:"h1",h2:"h2",header:"header",p:"p",pre:"pre",...(0,a.R)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(n.header,{children:(0,i.jsx)(n.h1,{id:"all-api-changes-to-08x",children:"All API changes to 0.8.X"})}),"\n",(0,i.jsx)(n.p,{children:"There are quite a few changes to the API.\nMake sure to read these changes before updating your extension."}),"\n",(0,i.jsxs)(n.h2,{id:"buildgradlekts-changes",children:[(0,i.jsx)(n.code,{children:"build.gradle.kts"})," Changes"]}),"\n",(0,i.jsxs)(n.p,{children:["Now the engine version is not specified in a seperate ",(0,i.jsx)(n.code,{children:"engine"})," block, but in the ",(0,i.jsx)(n.code,{children:"extension"})," block."]}),"\n",(0,i.jsxs)(s.A,{children:[(0,i.jsx)(l.A,{value:"release",label:"Release",default:!0,children:(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-kotlin",metastring:'title="build.gradle.kts" showLineNumbers',children:'import com.github.jengelman.gradle.plugins.shadow.tasks.ShadowJar\nplugins {\n    kotlin("jvm") version "2.0.21"\n    // highlight-red\n    id("com.typewritermc.module-plugin") version "1.0.1"\n    // highlight-green\n    id("com.typewritermc.module-plugin") version "1.1.2"\n}\n// Replace with your own information\ngroup = "me.yourusername"\nversion = "0.0.1"\ntypewriter {\n// highlight-red-start\n    engine {\n        version = "<latest typewriter version>"\n    }\n// highlight-red-end\n\n    namespace = "<a name for the company which all your extensions are published under>"\n\n    extension {\n        name = "<Name of the extension>"\n        shortDescription = "<Short description of the extension>"\n        description = "<Long description of the extension>"\n        // highlight-green\n        engineVersion = "<latest typewriter version>"\n\n        paper {\n            // Optional - If you want to make sure a plugin is required to be installed to use this extension\n            dependency("<plugin name>")\n        }\n    }\n}\nkotlin {\n    jvmToolchain(21)\n}\n'})})}),(0,i.jsx)(l.A,{value:"beta",label:"Beta",children:(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-kotlin",metastring:'title="build.gradle.kts" showLineNumbers',children:'import com.github.jengelman.gradle.plugins.shadow.tasks.ShadowJar\nplugins {\n    kotlin("jvm") version "2.0.21"\n    // highlight-red\n    id("com.typewritermc.module-plugin") version "1.0.1"\n    // highlight-green\n    id("com.typewritermc.module-plugin") version "1.1.2"\n}\n// Replace with your own information\ngroup = "me.yourusername"\nversion = "0.0.1"\ntypewriter {\n// highlight-red-start\n    engine {\n        version = "<latest typewriter version>"\n        channel = com.typewritermc.moduleplugin.ReleaseChannel.BETA\n    }\n// highlight-red-end\n\n    namespace = "<a name for the company which all your extensions are published under>"\n\n    extension {\n        name = "<Name of the extension>"\n        shortDescription = "<Short description of the extension>"\n        description = "<Long description of the extension>"\n        // highlight-green-start\n        engineVersion = "<latest typewriter version>"\n        channel = com.typewritermc.moduleplugin.ReleaseChannel.BETA\n        // highlight-green-end\n         \n        paper {\n            // Optional - If you want to make sure a plugin is required to be installed to use this extension\n            dependency("<plugin name>")\n        }\n    }\n}\nkotlin {\n    jvmToolchain(21)\n}\n'})})})]}),"\n",(0,i.jsxs)(n.h2,{id:"initializable-changes",children:[(0,i.jsx)(n.code,{children:"Initializable"})," Changes"]}),"\n",(0,i.jsxs)(n.p,{children:["The way to register a ",(0,i.jsx)(n.code,{children:"Initializable"})," has changed."]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-kotlin",metastring:"showLineNumbers",children:"// highlight-red\n@Initializer\n// highlight-green\n@Singleton\nobject ExampleInitializer : Initializable {\n    override suspend fun initialize() {\n        // Do something when the extension is initialized\n    }\n\n    override suspend fun shutdown() {\n        // Do something when the extension is shutdown\n    }\n}\n\n"})}),"\n",(0,i.jsx)(n.h2,{id:"triggering-entries-changes",children:"Triggering Entries Changes"}),"\n",(0,i.jsxs)(n.p,{children:["Since Typewriter now has ",(0,i.jsx)(n.code,{children:"InteractionContext"}),", this needs to be passed around when triggering entries.\nAs a lot changed, have a look at the ",(0,i.jsx)(n.a,{href:"../triggering",children:"Triggering Entries"})," page for more information."]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-kotlin",metastring:"showLineNumbers",children:"val entries: List<TriggerableEntry> = ...\n\n// highlight-red\nentries triggerAllFor player\n// highlight-green\nentries.triggerAllFor(player, context())\n"})}),"\n",(0,i.jsx)(n.h2,{id:"actionentry-changes",children:"ActionEntry Changes"}),"\n",(0,i.jsxs)(n.p,{children:["As the ",(0,i.jsx)(n.code,{children:"ActionEntry"})," now needs a ",(0,i.jsx)(n.code,{children:"InteractionContext"}),", the ",(0,i.jsx)(n.code,{children:"execute"})," function signature has changed."]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-kotlin",metastring:"showLineNumbers",children:'@Entry("example_action", "An example action entry.", Colors.RED, "material-symbols:touch-app-rounded")\nclass ExampleActionEntry(\n    override val id: String = "",\n    override val name: String = "",\n    override val criteria: List<Criteria> = emptyList(),\n    override val modifiers: List<Modifier> = emptyList(),\n    override val triggers: List<Ref<TriggerableEntry>> = emptyList(),\n) : ActionEntry {\n    // highlight-red-start\n    override fun execute(player: Player) {\n        super.execute(player) // This will apply all the modifiers.\n    // highlight-red-end\n    // highlight-green-start\n    override fun ActionTrigger.execute() {\n        // Will now automatically apply all the modifiers.\n    // highlight-green-end\n        // Do something with the player\n    }\n}\n'})}),"\n",(0,i.jsxs)(n.h2,{id:"removal-of-customtriggeringactionentry",children:["Removal of ",(0,i.jsx)(n.code,{children:"CustomTriggeringActionEntry"})]}),"\n",(0,i.jsx)(n.p,{children:"As the action entry now can specify itself how Typewriter should handle the triggering:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-kotlin",metastring:"showLineNumbers",children:'@Entry("example_action", "An example action entry.", Colors.RED, "material-symbols:touch-app-rounded")\nclass ExampleCustomTriggeringActionEntry(\n    override val id: String = "",\n    override val name: String = "",\n    override val criteria: List<Criteria> = emptyList(),\n    override val modifiers: List<Modifier> = emptyList(),\n// highlight-red-start\n    @SerializedName("triggers")\n    override val customTriggers: List<Ref<TriggerableEntry>> = emptyList(),\n) : CustomTriggeringActionEntry {\n    override fun execute(player: Player) {\n        super.execute(player) // This will apply the modifiers.\n        // Do something with the player\n        player.triggerCustomTriggers() // Can be called later to trigger the next entries.\n    // highlight-red-end\n// highlight-green-start\n    override val triggers: List<Ref<TriggerableEntry>> = emptyList(),\n) : ActionEntry {\n override fun ActionTrigger.execute() {\n        // This disables Typewriter\'s automatic triggering of the next entries,\n        // and disables the automatic apply of the modifiers.\n        disableAutomaticTriggering()\n\n        // Now you can manually trigger the next entries.\n        triggerManually()\n\n        // Or if you want to specify which triggers to trigger, you can do so.\n        triggers.filterIndexed { index, _ -> index % 2 == 0 }.triggerFor(player)\n\n        // You can also manually apply the modifiers.\n        applyModifiers()\n        // highlight-green-end\n    }\n}\n'})}),"\n",(0,i.jsx)(n.h2,{id:"dialogue-messenger-changes",children:"Dialogue Messenger Changes"}),"\n",(0,i.jsxs)(n.p,{children:["As it was the only place in Typewriter where you had to register something with an annotation, we changed it to allow the DialogueEntry to specify the messengers that it uses.\nAdditionally, we now need to forward the ",(0,i.jsx)(n.code,{children:"context"})," parameter to the messengers."]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-kotlin",metastring:"showLineNumbers",children:'@Entry("example_dialogue", "An example dialogue entry.", Colors.BLUE, "material-symbols:chat-rounded")\nclass ExampleDialogueEntry(\n    override val id: String = "",\n    override val name: String = "",\n    override val criteria: List<Criteria> = emptyList(),\n    override val modifiers: List<Modifier> = emptyList(),\n    override val triggers: List<Ref<TriggerableEntry>> = emptyList(),\n    override val speaker: Ref<SpeakerEntry> = emptyRef(),\n    @MultiLine\n    @Placeholder\n    @Colored\n    @Help("The text to display to the player.")\n    val text: String = "",\n) : DialogueEntry {\n    // highlight-green-start\n    // May return null to skip the dialogue\n    override fun messenger(player: Player, context: InteractionContext): DialogueMessenger<*>? {\n        // You can use if statements to return a different messenger depending on different conditions\n        return ExampleDialogueDialogueMessenger(player, context, this)\n    }\n    // highlight-green-end\n}\n\n// highlight-red-start\n@Messenger(ExampleDialogueEntry::class)\nclass ExampleDialogueDialogueMessenger(player: Player, entry: ExampleDialogueEntry) :\n    DialogueMessenger<ExampleDialogueEntry>(player, entry) {\n\n    companion object : MessengerFilter {\n        override fun filter(player: Player, entry: DialogueEntry): Boolean = true\n    }\n    // highlight-red-end\n// highlight-green-start\nclass ExampleDialogueDialogueMessenger(player: Player, context: InteractionContext, entry: ExampleDialogueEntry) :\n    DialogueMessenger<ExampleDialogueEntry>(player, context, entry) {\n// highlight-green-end\n\n\n    // Called every game tick (20 times per second).\n    // The cycle is a parameter that is incremented every tick, starting at 0.\n    override fun tick(context: TickContext) {\n        super.tick(context)\n        if (state != MessengerState.RUNNING) return\n\n        player.sendMessage("${entry.speakerDisplayName}: ${entry.text}".parsePlaceholders(player).asMini())\n\n        // When we want the dialogue to end, we can set the state to FINISHED.\n        state = MessengerState.FINISHED\n    }\n}\n'})}),"\n",(0,i.jsxs)(n.h2,{id:"suspendable-audienceentrydisplay",children:["Suspendable ",(0,i.jsx)(n.code,{children:"AudienceEntry#display"})]}),"\n",(0,i.jsxs)(n.p,{children:["To allow audience entries to have some async loading behaviour, the ",(0,i.jsx)(n.code,{children:"display"})," now is a suspendable function."]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-kotlin",metastring:"showLineNumbers",children:'\t@Entry("example_audience", "An example audience entry.", Colors.GREEN, "material-symbols:chat-rounded")\nclass ExampleAudienceEntry(\n    override val id: String = "",\n    override val name: String = "",\n) : AudienceEntry {\n// highlight-red\n    override fun display(): AudienceDisplay {\n// highlight-green\n    override suspend fun display(): AudienceDisplay {\n        return ExampleAudienceDisplay()\n    }\n}\n'})})]})}function g(e={}){const{wrapper:n}={...(0,a.R)(),...e.components};return n?(0,i.jsx)(n,{...e,children:(0,i.jsx)(h,{...e})}):h(e)}},19365:(e,n,t)=>{t.d(n,{A:()=>s});t(96540);var r=t(34164);const i={tabItem:"tabItem_Ymn6"};var a=t(74848);function s(e){let{children:n,hidden:t,className:s}=e;return(0,a.jsx)("div",{role:"tabpanel",className:(0,r.A)(i.tabItem,s),hidden:t,children:n})}},11470:(e,n,t)=>{t.d(n,{A:()=>j});var r=t(96540),i=t(34164),a=t(23104),s=t(56347),l=t(205),o=t(57485),d=t(31682),c=t(70679);function u(e){return r.Children.toArray(e).filter((e=>"\n"!==e)).map((e=>{if(!e||(0,r.isValidElement)(e)&&function(e){const{props:n}=e;return!!n&&"object"==typeof n&&"value"in n}(e))return e;throw new Error(`Docusaurus error: Bad <Tabs> child <${"string"==typeof e.type?e.type:e.type.name}>: all children of the <Tabs> component should be <TabItem>, and every <TabItem> should have a unique "value" prop.`)}))?.filter(Boolean)??[]}function h(e){const{values:n,children:t}=e;return(0,r.useMemo)((()=>{const e=n??function(e){return u(e).map((e=>{let{props:{value:n,label:t,attributes:r,default:i}}=e;return{value:n,label:t,attributes:r,default:i}}))}(t);return function(e){const n=(0,d.XI)(e,((e,n)=>e.value===n.value));if(n.length>0)throw new Error(`Docusaurus error: Duplicate values "${n.map((e=>e.value)).join(", ")}" found in <Tabs>. Every value needs to be unique.`)}(e),e}),[n,t])}function g(e){let{value:n,tabValues:t}=e;return t.some((e=>e.value===n))}function p(e){let{queryString:n=!1,groupId:t}=e;const i=(0,s.W6)(),a=function(e){let{queryString:n=!1,groupId:t}=e;if("string"==typeof n)return n;if(!1===n)return null;if(!0===n&&!t)throw new Error('Docusaurus error: The <Tabs> component groupId prop is required if queryString=true, because this value is used as the search param name. You can also provide an explicit value such as queryString="my-search-param".');return t??null}({queryString:n,groupId:t});return[(0,o.aZ)(a),(0,r.useCallback)((e=>{if(!a)return;const n=new URLSearchParams(i.location.search);n.set(a,e),i.replace({...i.location,search:n.toString()})}),[a,i])]}function m(e){const{defaultValue:n,queryString:t=!1,groupId:i}=e,a=h(e),[s,o]=(0,r.useState)((()=>function(e){let{defaultValue:n,tabValues:t}=e;if(0===t.length)throw new Error("Docusaurus error: the <Tabs> component requires at least one <TabItem> children component");if(n){if(!g({value:n,tabValues:t}))throw new Error(`Docusaurus error: The <Tabs> has a defaultValue "${n}" but none of its children has the corresponding value. Available values are: ${t.map((e=>e.value)).join(", ")}. If you intend to show no default tab, use defaultValue={null} instead.`);return n}const r=t.find((e=>e.default))??t[0];if(!r)throw new Error("Unexpected error: 0 tabValues");return r.value}({defaultValue:n,tabValues:a}))),[d,u]=p({queryString:t,groupId:i}),[m,y]=function(e){let{groupId:n}=e;const t=function(e){return e?`docusaurus.tab.${e}`:null}(n),[i,a]=(0,c.Dv)(t);return[i,(0,r.useCallback)((e=>{t&&a.set(e)}),[t,a])]}({groupId:i}),v=(()=>{const e=d??m;return g({value:e,tabValues:a})?e:null})();(0,l.A)((()=>{v&&o(v)}),[v]);return{selectedValue:s,selectValue:(0,r.useCallback)((e=>{if(!g({value:e,tabValues:a}))throw new Error(`Can't select invalid tab value=${e}`);o(e),u(e),y(e)}),[u,y,a]),tabValues:a}}var y=t(92303);const v={tabList:"tabList__CuJ",tabItem:"tabItem_LNqP"};var x=t(74848);function f(e){let{className:n,block:t,selectedValue:r,selectValue:s,tabValues:l}=e;const o=[],{blockElementScrollPositionUntilNextRender:d}=(0,a.a_)(),c=e=>{const n=e.currentTarget,t=o.indexOf(n),i=l[t].value;i!==r&&(d(n),s(i))},u=e=>{let n=null;switch(e.key){case"Enter":c(e);break;case"ArrowRight":{const t=o.indexOf(e.currentTarget)+1;n=o[t]??o[0];break}case"ArrowLeft":{const t=o.indexOf(e.currentTarget)-1;n=o[t]??o[o.length-1];break}}n?.focus()};return(0,x.jsx)("ul",{role:"tablist","aria-orientation":"horizontal",className:(0,i.A)("tabs",{"tabs--block":t},n),children:l.map((e=>{let{value:n,label:t,attributes:a}=e;return(0,x.jsx)("li",{role:"tab",tabIndex:r===n?0:-1,"aria-selected":r===n,ref:e=>{o.push(e)},onKeyDown:u,onClick:c,...a,className:(0,i.A)("tabs__item",v.tabItem,a?.className,{"tabs__item--active":r===n}),children:t??n},n)}))})}function b(e){let{lazy:n,children:t,selectedValue:a}=e;const s=(Array.isArray(t)?t:[t]).filter(Boolean);if(n){const e=s.find((e=>e.props.value===a));return e?(0,r.cloneElement)(e,{className:(0,i.A)("margin-top--md",e.props.className)}):null}return(0,x.jsx)("div",{className:"margin-top--md",children:s.map(((e,n)=>(0,r.cloneElement)(e,{key:n,hidden:e.props.value!==a})))})}function w(e){const n=m(e);return(0,x.jsxs)("div",{className:(0,i.A)("tabs-container",v.tabList),children:[(0,x.jsx)(f,{...n,...e}),(0,x.jsx)(b,{...n,...e})]})}function j(e){const n=(0,y.A)();return(0,x.jsx)(w,{...e,children:u(e.children)},String(n))}}}]);